<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta content="IE=edge,chrome=1" http-equiv=X-UA-Compatible><meta content="width=device-width,minimum-scale=1" name=viewport><title>Sergio Carracedo | Understanding d3.js - A simple line chart</title>
<meta content="yes" name=mobile-web-app-capable><meta content="black-translucent" name=apple-mobile-web-app-status-bar-style><meta content="Sergio Carracedo's personal page and blog" name=description><meta content="Sergio Carracedo" name=author><link href=https://sergiocarracedo.es//index.xml rel=alternate title="Sergio Carracedo" type=application/rss+xml><link href=/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/site.webmanifest rel=manifest><link color=#5bbad5 href=/safari-pinned-tab.svg rel=mask-icon><meta content="#da532c" name=msapplication-TileColor><meta content="#ffffff" name=theme-color><link crossorigin href="https://fonts.googleapis.com/css2?family=Rozha+One:wght@400;500;600;700&display=swap" rel=preconnect><link crossorigin href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;500;600;700&display=swap" rel=preconnect><link crossorigin href="https://fonts.googleapis.com/css2?family=Allura:wght@400;500;600;700&display=swap" rel=preconnect><meta property="og:title" content="Understanding d3.js - A simple line chart"><meta property="og:description" content="Before starting is important to say that d3.js is not a chart library is a library for making charts, if you are expecting to pass the data to the library and set 4, 5,&mldr; 10 params and get the chart to render, d3.js is not your library.
d3.js is more than that, is a very flexible library to manage data (data-driven documents) and create the representation of that data (not only charts). d3.js provides you the different pieces to create your customized data visualizations (for example charts)"><meta property="og:type" content="article"><meta property="og:url" content="https://sergiocarracedo.es/understanding-d3-js-introduction/"><meta property="og:image" content="https://sergiocarracedo.es/understanding-d3-js-introduction/d3js_intro_hu5231462366378505333.jpg"><meta name=twitter:image content="https://sergiocarracedo.es/understanding-d3-js-introduction/d3js_intro_hu5231462366378505333.jpg"></meta><meta property="article:section" content="blog">
<meta property="article:published_time" content="2021-04-19T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-19T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"></meta>
<link href=https://sergiocarracedo.es/understanding-d3-js-introduction/ rel=canonical><link href=https://sergiocarracedo.es/scss/main.min.c6aeadd0f64f9e58a5f36b759b3c5f69f04adcbaf95c581a64fdd28dfd1410e8.css integrity="sha256-xq6t0PZPnlil82t1mzxfafBK3Lr5XFgaZP3Sjf0UEOg=" rel="stylesheet preconnect"><link as=style href=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css rel="stylesheet preload" type=text/css></head><body><header class="web-header background-paper-secondary"><h2><a class=back-to-home href=/ title="Back to home"><i class="fas fa-home"></i><div class=back-to-home__content><span class=back-to-home__action>Back to home</span><div class=back-to-home__title><img alt="Sergio Carracedo" class=avatar src=/i/sergiocarracedo_hu15161314200389136556.jpg width=100 height=100><h4>Sergio Carracedo</h4></div></div></a></h2><div class=web-header__page-title><span>Understanding d3.js - A simple line chart</span></div><div class=theme-switch><i class="theme-switch__theme fas fa-sun" id=theme-switch-light title="Switch to light theme"></i>
<i class="theme-switch__theme fas fa-moon" id=theme-switch-dark title="Switch to dark theme"></i></div></header><div class=main-content><article class="post post--single"><div class="post__main wrapper-1200"><aside class=post__metadata><time class=post__date datetime=2021-04-19><i class="far fa-calendar-alt"></i> Apr 19, 2021
</time><a href=https://sergiocarracedo.es/tags/d3 class=post__tag><span>d3</span>
</a><a href=https://sergiocarracedo.es/tags/js class=post__tag><span>js</span>
</a><span class=post__reading-time><i class="far fa-clock"></i> 7 minutes read</span></aside><header class=post__header><h1 class=post__title>Understanding d3.js - A simple line chart</h1></header><figure class=post__cover><img alt="Understanding d3.js - A simple line chart" height=400 src=/understanding-d3-js-introduction/d3js_intro_hu4908987523589729188.jpg width=1200></figure><div class=post__content><p>Before starting is important to say that <strong>d3.js is not a chart library is a library for making charts</strong>, if you are expecting to pass the data to the library and set 4, 5,&mldr; 10 params and get the chart to render, d3.js is not your library.</p><p><a href=https://d3js.org/>d3.js</a> is more than that, is a very flexible library to manage data (data-driven documents) and create the representation of that data (not only charts). <strong>d3.js</strong> provides you the different pieces to create your customized data visualizations (for example charts)</p><p>Let&rsquo;s start creating a simple line chart:</p><p><figure class=image-caption><img src=/understanding-d3-js-introduction/line-chart_hu14527381548716268906.jpg alt title width=1100 height=345 srcset="/understanding-d3-js-introduction/line-chart_hu5424946162281874207.webp 458w, /understanding-d3-js-introduction/line-chart_hu18294024564058847782.webp 768w, /understanding-d3-js-introduction/line-chart_hu15185348949397949978.webp 1234w" sizes="(max-width: 458px) 100vw, (max-width: 768px) 100vw, 1234px"><figcaption></figcaption></figure></p><h1 id=scales-domain-and-range>Scales, domain, and range</h1><p>Simplifying, there are two pieces in the chart: Axis and line. Let&rsquo;s talk about the axis.
In the example the chart we have two axes: X and Y, but we can have more or less, depending on the chart type.</p><p>Axis is one of the reference lines of a coordinate system, every single point represents a value in the coordinate system and also a position in the canvas which is displaying the chart.</p><p>In our example, in the y-axis the &lsquo;1&rsquo; value of the chart is drawn in the position 31px from the axis start, but in SVG or canvas the origin of the coordinate system start on the top left corner, and &lsquo;y&rsquo; grows in the direction to monitor bottom. Then to print the 1 value in our chart we must use 319 - 31 (288) as y position.<figure class=image-caption><img src=/understanding-d3-js-introduction/line-chart-axis_hu17322867676489857473.jpg alt title width=1100 height=345 srcset="/understanding-d3-js-introduction/line-chart-axis_hu8987186233501828958.webp 458w, /understanding-d3-js-introduction/line-chart-axis_hu7600936006486960605.webp 768w, /understanding-d3-js-introduction/line-chart-axis_hu2646562967448836353.webp 1234w" sizes="(max-width: 458px) 100vw, (max-width: 768px) 100vw, 1234px"><figcaption></figcaption></figure></p><p>That&rsquo;s complicated, and can be even more, if the relation between screen coordinates and chart coordinates aren&rsquo;t lineal, for example, a logarithmic chart.</p><p><strong>d3.js</strong> brings us a component to help us to abstract the conversion between screen coordinates and chart coordinates:</p><h2 id=d3-scale>d3-scale</h2><p><a href=https://github.com/d3/d3-scale><strong>d3-scale</strong></a> is our component.
There are a lot of different types of scales: Continuous (Linear, Power, log, identity, time, radial), Sequential, Ordinal, etc&mldr; For our example chart, we will use Linear.</p><p>Before continuing with <em>scale</em> I&rsquo;m going to introduce 2 important concepts: <strong>domain</strong> and <strong>range</strong></p><p><strong>Domain</strong> is the complete set of values chart can use, in our case is all the values between 0 and 10</p><p><strong>Range</strong> is the coordinates (in the screen) where the chart can draw, in this case from 0 to 319</p><p>Putting all together:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>xScale</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>.<span style=color:#a6e22e>scaleLinear</span>().<span style=color:#a6e22e>domain</span>([<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10</span>]).<span style=color:#a6e22e>range</span>([<span style=color:#ae81ff>319</span>, <span style=color:#ae81ff>0</span>]) 
</span></span></code></pre></div><blockquote><p>Note the range is between <code>319</code> and <code>0</code> not between <code>0</code> and <code>319</code></p></blockquote><p>This returns a function that links the values in the chart (domain), and the values in the &lsquo;canvas&rsquo; (range)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>xScale</span>(<span style=color:#ae81ff>0</span>) <span style=color:#75715e>// 319
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>xScale</span>(<span style=color:#ae81ff>5</span>) <span style=color:#75715e>// 159.5
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>xScale</span>(<span style=color:#ae81ff>10</span>) <span style=color:#75715e>// 0
</span></span></span></code></pre></div><p>Scale also provides some methods for do extra actions, for example, if you want to get the value in the chart from the &lsquo;canvas&rsquo; coordinates (the typical use case is getting the chart value in the mouse position) we can use</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>xScale</span>.<span style=color:#a6e22e>invert</span>(<span style=color:#ae81ff>159.5</span>) <span style=color:#75715e>// 5
</span></span></span></code></pre></div><blockquote><p>Probably you are thinking the same as me the first time I see that: It&rsquo;s a function that has methods? WTF!. If you want you can go farther but in swallow, if the function has arguments returns the &lsquo;main&rsquo; value, if not returns an object of functions.</p></blockquote><p>We can do the same for the y-axis:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>yScale</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>.<span style=color:#a6e22e>scaleLinear</span>().<span style=color:#a6e22e>domain</span>([<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>20</span>]).<span style=color:#a6e22e>range</span>([<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>700</span>]) 
</span></span></code></pre></div><p>Ok, we have all the tools to manage the data and the canvas, now we must render the data and the axis</p><h1 id=rendering-the-chart>Rendering the chart</h1><p><strong>d3.js</strong> can render charts in <strong>SVG</strong> and <strong>Canvas</strong> but we will focus on the SVG rendering because is fast enough for most charts and makes easy interaction and styling.
To render our line chart, first, we must prepare our placeholder.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;chart&#39;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></div><p>For our comfort I&rsquo;m going to define the chart margins and the width and height. The margins are necessary to render the axis, because the size of the chart refers to the draw area.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>margin</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>50</span>, <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>50</span> }
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1280</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>left</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>right</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>420</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>top</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>bottom</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>n</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span> <span style=color:#75715e>// Number of points in x axis
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>maxY</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span> <span style=color:#75715e>// Max y value
</span></span></span></code></pre></div><p>Now we will use <em>d3</em> to add our SVG chart</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>svg</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>select</span>(<span style=color:#e6db74>&#39;.chart&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>append</span>(<span style=color:#e6db74>&#39;svg&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#39;width&#39;</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>left</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>right</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#39;height&#39;</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>top</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>bottom</span>)
</span></span></code></pre></div><p>Line by line:</p><ul><li><code>.select('.chart')</code> selects the DOM element previously we defined</li><li><code>.append('svg')</code> appends a <code>&lt;svg></code> element to the <code>&lt;div class='chart'></code></li><li><code>.attr('width', width + margin.left + margin.right)</code> adds an <code>width</code> attribute to the <code>&lt;svg></code> element</li><li><code>.attr('height', height + margin.top + margin.bottom)</code> adds an <code>hight</code> attribute to the <code>&lt;svg></code> element</li></ul><p>We defined the scales above, but we will do it again, now using our variables to make the chart more reusable</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>xScale</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>.<span style=color:#a6e22e>scaleLinear</span>().<span style=color:#a6e22e>domain</span>([<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>n</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]).<span style=color:#a6e22e>range</span>([<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>width</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>yScale</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>.<span style=color:#a6e22e>scaleLinear</span>().<span style=color:#a6e22e>domain</span>([<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>maxY</span>]).<span style=color:#a6e22e>range</span>([<span style=color:#a6e22e>height</span>, <span style=color:#ae81ff>0</span>])
</span></span></code></pre></div><h3 id=rendering-the-x-axis>Rendering the x-axis</h3><p>To render the X axis we will create a new SVG group that holds the axis</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>svg</span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>append</span>(<span style=color:#e6db74>&#39;g&#39;</span>)
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#39;class&#39;</span>, <span style=color:#e6db74>&#39;x axis&#39;</span>)
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#39;transform&#39;</span>, <span style=color:#e6db74>&#39;translate(&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>left</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;,&#39;</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>height</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>top</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;)&#39;</span>)
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>call</span>(<span style=color:#a6e22e>d3</span>.<span style=color:#a6e22e>axisBottom</span>(<span style=color:#a6e22e>xScale</span>))
</span></span></code></pre></div><p>Line by line:</p><ul><li><code>.append('g')</code> appends the new group for the axis</li><li><code>.attr('class', 'axis x-axis')</code> adds 2 classes to the group (this allows us to style it using CSS)</li><li><code>.attr('transform', 'translate(' + margin.left + ',' + height + ')')</code> moves the axis group bellow the chart draw area and gives space</li><li><code>.call(d3.axisBottom(xScale))</code> call the <code>d3.axisBottom</code> function. This function is in charge of rendering the axis, the <em>axisBottom</em> means that the ticks of the axis will be rendered bellow the axis line. There are 3 more functions: <code>d3.axisTop</code>, <code>d3.axisLeft</code>, <code>d3.axisRight</code> to render the axis in different orientations.</li></ul><blockquote><p>About the <a href=https://github.com/d3/d3-selection/blob/v2.0.0/README.md#selection_call><code>call</code></a> method: This method call the function passed as argument and uses as first argument for the function of the selected element. In this case is the same as execute: <code>d3.axisBottom(xScale)(svg.select('.xaxis'))</code> (Remember that d3.axisBottom returns a function). The advantage of using <code>call</code> is you can concatenate methods because call returns the selection, not the result of the function</p></blockquote><p>After that we can see our x-axis &#x1f389;</p><h3 id=rendering-the-y-axis>Rendering the y-axis</h3><p>Rendering the Y axis is almost the same as X axis:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>svg</span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>append</span>(<span style=color:#e6db74>&#39;g&#39;</span>)
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#39;class&#39;</span>, <span style=color:#e6db74>&#39;y axis&#39;</span>)
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#39;transform&#39;</span>, <span style=color:#e6db74>&#39;translate(&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>left</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;,&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>top</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;)&#39;</span>)
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>call</span>(<span style=color:#a6e22e>d3</span>.<span style=color:#a6e22e>axisLeft</span>(<span style=color:#a6e22e>yScale</span>))
</span></span></code></pre></div><h2 id=rendering-the-line>Rendering the line</h2><p>Before do the chart rendering we need the data, in this case, we will use random values</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>dataset</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>.<span style=color:#a6e22e>range</span>(<span style=color:#a6e22e>n</span>).<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>d</span>) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>d</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>d3</span>.<span style=color:#a6e22e>randomUniform</span>(<span style=color:#a6e22e>yMax</span>)() }
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>[
</span></span></span><span style=display:flex><span><span style=color:#75715e>  { x: 0, y: 2.679771859053788 },
</span></span></span><span style=display:flex><span><span style=color:#75715e>  { x: 1, y: 5.447777017888336 },
</span></span></span><span style=display:flex><span><span style=color:#75715e>  ...
</span></span></span><span style=display:flex><span><span style=color:#75715e>  { x: 19, y: 0.083980807899251 }
</span></span></span><span style=display:flex><span><span style=color:#75715e>]
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span></code></pre></div><p>Now we will create the line generator that is a function that returns a</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>line</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>line</span>()
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>x</span>((<span style=color:#a6e22e>d</span>) =&gt; <span style=color:#a6e22e>xScale</span>(<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>x</span>))
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>y</span>((<span style=color:#a6e22e>d</span>) =&gt; <span style=color:#a6e22e>yScale</span>(<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>y</span>))
</span></span></code></pre></div><p>Line by line:</p><ul><li><code>.line()</code> is the basic line generator</li><li><code>.x((d) => xScale(d.x))</code> function that for every point in data set returns the x position in the draw area, this is the reason why we are using the scale function. <em>d</em> represent every dataset point</li><li><code>.y((d) => xScale(d.y)</code> same as previous line but referred to y-axis</li></ul><p>We can also add an extra call to the line generator to configure the interpolation behavior, for example: <code>.curve(d3.curveMonotoneX)</code> that makes the curve softer. But for now, a simple interpolation (linear) is enough.</p><p>Ok, now we have the line generator, and it&rsquo;s time to draw the line in our chart.</p><p>First, we add a SVG group for the line we will draw</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>lineWrapper</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>svg</span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>append</span>(<span style=color:#e6db74>&#39;g&#39;</span>)
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#39;transform&#39;</span>, <span style=color:#e6db74>&#39;translate(&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>left</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;,&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>margin</span>.<span style=color:#a6e22e>top</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;)&#39;</span>);
</span></span></code></pre></div><p>Line by line:</p><ul><li><code>.append('g')</code> appends a SVG group element (<code>g</code>) to the <code>svg</code> element. This group will contain the chart draw area</li><li><code>.attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')</code> set the transform attribute to move the group, this makes easy managing the draw, because we don&rsquo;t need to take care of the real position, for the draw area the coordinate system starts on (0, 0)</li></ul><p>And the render the line</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>lineWrapper</span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>append</span>(<span style=color:#e6db74>&#39;path&#39;</span>)
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>datum</span>(<span style=color:#a6e22e>dataset</span>)
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#39;class&#39;</span>, <span style=color:#e6db74>&#39;line&#39;</span>)
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>attr</span>(<span style=color:#e6db74>&#39;d&#39;</span>, <span style=color:#a6e22e>line</span>)
</span></span></code></pre></div><p>Line by line:</p><ul><li><code>.append('path')</code> appends a path element (to draw the line)</li><li><code>.datum(dataset)</code> assigns the dataset to the path element (we will use it in the next lines)</li><li><code>.attr('class', 'line')</code> add the class <code>line</code> to the path element to make asy the css styling</li><li><code>.attr('d', line)</code> add the <code>d</code> attribute, to generate it class to the line generator passing the element, and the <code>datum</code></li></ul><blockquote><p>We used <code>datum</code> because data is static, but d3 provides other methods to link dynamic data to the dom elements, but I will talk about that in the future</p></blockquote><p>And this is all for the moment. <em>d3</em> is a powerful tool but needs you to know some concepts before starting to create charts. The example we did in this post is very, very simple but I think is a good starting point.</p><p>My idea is to write more post about <em>d3</em> going deeper into the current concept and how to configure and customize the current components (for example configure the axis, the labels, etc)
<iframe frameborder=0 marginheight=0 marginwidth=0 width=100% height=400px type=text/html src="https://codesandbox.io/embed/sharp-water-bmk3t?fontsize=14&amp;hidenavigation=1&amp;theme=dark&amp;view=preview"></iframe></p></div></div><aside class=post__nav-wrapper><div class=wrapper-1200><div class="post-nav post-nav--prev"><a class=post-nav__link href="https://sergiocarracedo.es/tips-using-typescript-and-vue/?ref=footer"><div class="post-nav__cover btn btn--img btn--hover-parent"><img alt=.Next.Title src=/tips-using-typescript-and-vue/vue-typescript-tips-rF4kuvgHhU-unsplash_hu7141676424024164706.jpg width=200 height=120></div><div class=post-nav__title>Tips using Typescript and Vue</div></a></div><div class=blog-link><a class="btn btn--outlined" href=https://sergiocarracedo.es/blog>All Blog posts</a></div><div class="post-nav post-nav--next"><a class=post-nav__link href="https://sergiocarracedo.es/custom-svg-icon-set-management-with-vue/?ref=footer"><div class="post-nav__cover btn btn--img btn--hover-parent"><img alt=.Prev.Title class=post-nav__cover src=/custom-svg-icon-set-management-with-vue/svg-iconset_hu4915185929825608474.jpg width=200 height=120></div><div class=post-nav__title>Custom SVG icon set management with Vue</div></a></div></div><div class="wrapper-1200 post__nav-years"><ul class=years><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2024>2024</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2023>2023</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2022>2022</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2021>2021</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2020>2020</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2019>2019</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2018>2018</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2017>2017</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2016>2016</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2015>2015</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2013>2013</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2012>2012</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2011>2011</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2010>2010</a></li></ul></div></aside><aside class=post__search-wrapper><div class=wrapper-1200>Search in <strong>146</strong> blog posts:<form action=https://sergiocarracedo.es/search class="search-form search-form--dark search-form--l" method=get><label for=search-input hidden>Search</label>
<input class=search-form__input id=search-input name=query placeholder=Search type=text>
<button aria-label="Search in the blog" class=search-form__button>
<i class="fas fa-search"></i></button></form></div></aside><aside class=post__comments><div class=wrapper-1200><div id=disqus_thread>To show comments is mandatory to accept cookie policy.</div></div></aside></article></div><footer class="web-footer background-paper-secondary"><div class=wrapper-1200><div class=web-footer__left><div class=me><div class=me__avatar><img alt="Sergio Carracedo" height=180 src=/i/sergiocarracedo_hu3613990337080381956.jpg width=180></div><div class=me__titles><h1>Sergio Carracedo</h1><h2>Senior Fullstack developer.</h2><h3>Always learning, cats, good conversations and small details lover.</h3></div></div></div><div class=web-footer__right><nav class=menu><ul role=menu><li class=menu__item role=presentation><a role=menuitem href=https://sergiocarracedo.es/>Home</a></li><li class=menu__item role=presentation><a role=menuitem href=https://sergiocarracedo.es/blog>Blog</a></li><li class=menu__item role=presentation><a role=menuitem href=https://sergiocarracedo.es/index.xml>RSS Feed</a></li></ul></nav><div class=social><a class=social__link href=http://www.linkedin.com/in/sergiocarracedo target=_blank title=LinkedIn style=animation-delay:2s><i class="fab fa-linkedin"></i>
</a><a class=social__link href=mailto:hi+blog@sergiocarracedo.es target=_blank title=Email style=animation-delay:1.9333333333333333s><i class="fas fa-envelope"></i>
</a><a class=social__link href=https://github.com/sergiocarracedo target=_blank title=GitHub style=animation-delay:1.8666666666666667s><i class="fab fa-github"></i>
</a><a class=social__link href=https://bsky.app/profile/sergiocarracedo.es target=_blank title=Bluesky style=animation-delay:1.8s><svg fill="none" viewBox="0 0 64 57"><path fill="currentcolor" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022.0 8.51.0 6.55.0-3.268 8.579-.182 13.873 3.805zm36.254.0C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745z"/></svg>
</a><a class=social__link href=https://www.drupal.org/u/sergiocarracedo target=_blank title=Drupal style=animation-delay:1.7333333333333334s><i class="fab fa-drupal"></i>
</a><a class=social__link href=https://www.npmjs.com/~sergiocarracedo target=_blank title=Npm style=animation-delay:1.6666666666666667s><svg viewBox="0 0 780 250" aria-hidden="true"><path fill="currentcolor" d="M240 250h1e2v-50h1e2V0H240V250zM340 50h50v1e2h-50V50zM480 0v2e2h1e2V50h50v150h50V50h50v150h50V0H480zM0 2e2h1e2V50h50v150h50V0H0V2e2z" stroke-width="5" stroke="currentcolor"/></svg>
</a><a class=social__link href=https://www.twitter.com/sergiocarracedo target=_blank title=Twitter style=animation-delay:1.6s><i class="fab fa-twitter"></i>
</a><a class=social__link href=http://www.last.fm/user/gasman40 target=_blank title=Last.fm style=animation-delay:1.5333333333333332s><i class="fab fa-lastfm"></i>
</a><a class=social__link href=http://sergiocarracedo.tumblr.com/ target=_blank title=Tumblr style=animation-delay:1.4666666666666668s><i class="fab fa-tumblr"></i></a></div></div></div></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-87X78TXEGE"></script><script>function runGA(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-87X78TXEGE")}</script><script>function runDisqus(){(function(){var e=document,t=e.createElement("script");t.src="https://sergiocarracedo.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()}</script><script src=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js></script><script>window.addEventListener("load",function(){window.cookieconsent.initialise({palette:{popup:{background:"#004262",text:"#fff"},button:{background:"#8ec760",text:"#ffffff"}},type:"opt-out",content:{message:"Este sitio usa cookies propias y de terceros para mejorar la experiencia de usuario y esas cosas.",allow:"Ok, continua",deny:"Nada de cookies",link:"Saber m√°s",href:"https://sergiocarracedo.es/cookies"},onStatusChange:function(e){e=="allow"&&runCookiesAllowed()},onInitialise:function(e){e=="allow"&&runCookiesAllowed()}})})</script><script>addEventListener("scroll",e=>{let t=document.getElementsByTagName("body")[0];t&&window.scrollY>10?t.classList.add("not-in-top"):t.classList.remove("not-in-top")});function runCookiesAllowed(){runGA(),runDisqus()}</script><script integrity="sha256-hyPros3hoBf0jJM1+zayQLFFkchXwy4d/k2QMvk0sHs=" src=https://sergiocarracedo.es/js/theme.min.8723eba2cde1a017f48c9335fb36b240b14591c857c32e1dfe4d9032f934b07b.js></script><script src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js type=text/javascript></script><script integrity="sha256-9aiKKMxF0IhB2gmJbfgVOjk8GCtKW7zP2MwD74dPfDo=" src=https://sergiocarracedo.es/js/search.min.f5a88a28cc45d08841da09896df8153a393c182b4a5bbccfd8cc03ef874f7c3a.js></script></body></html>