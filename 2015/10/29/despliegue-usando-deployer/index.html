<!doctype html><html><head><meta charset=UTF-8><meta content="IE=edge,chrome=1" http-equiv=X-UA-Compatible><meta content="width=device-width,minimum-scale=1" name=viewport><title>Sergio Carracedo | Despliegue usando Deployer</title>
<meta content="yes" name=apple-mobile-web-app-capable><meta content="black-translucent" name=apple-mobile-web-app-status-bar-style><meta content="Sergio Carracedo's personal page and blog" name=description><meta content="Sergio Carracedo" name=author><link href=/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/site.webmanifest rel=manifest><link color=#5bbad5 href=/safari-pinned-tab.svg rel=mask-icon><meta content="#da532c" name=msapplication-TileColor><meta content="#ffffff" name=theme-color><link crossorigin href="https://fonts.googleapis.com/css2?family=Rozha+One:wght@400;500;600;700&display=swap" rel=preconnect><link crossorigin href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;500;600;700&display=swap" rel=preconnect><link crossorigin href="https://fonts.googleapis.com/css2?family=Allura:wght@400;500;600;700&display=swap" rel=preconnect><meta property="og:title" content="Despliegue usando Deployer"><meta property="og:description" content="Desde el momento que ponemos un sistema en producción y necesitamos mantener el código o continuar el desarrollo surge una tediosa tarea, subir los cambios al servidor de producción. Esto normalmente lo hacemos empleando un FTP mediante el cual subimos los ficheros modificados. Pero ahi esta el &ldquo;problema&rdquo;, en muchos casos conocer los ficheros que se han modificado (aunque lo podemos hacer empleando git y comparando commits para obtener una lista de archivos cambiados) y una vez que los conocemos debemos subir a mano los ficheros modificados. "><meta property="og:type" content="article"><meta property="og:url" content="https://sergiocarracedo.es/2015/10/29/despliegue-usando-deployer/"><meta property="og:image" content="https://sergiocarracedo.es/2015/10/29/despliegue-usando-deployer/deployer_hu7672587319604304487.png"><meta name=twitter:image content="https://sergiocarracedo.es/2015/10/29/despliegue-usando-deployer/deployer_hu7672587319604304487.png"></meta><meta property="article:section" content="blog">
<meta property="article:published_time" content="2015-10-29T00:00:00+00:00"><meta property="article:modified_time" content="2015-10-29T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"></meta>
<link href=https://sergiocarracedo.es/2015/10/29/despliegue-usando-deployer/ rel=canonical><link href=https://sergiocarracedo.es/scss/main.min.eb2c7eed36db73868d33fc79aad24debed56125f83ac18652aad76126b0014a7.css integrity="sha256-6yx+7Tbbc4aNM/x5qtJN6+1WEl+DrBhlKq12EmsAFKc=" rel="stylesheet preconnect"><link href=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css rel="stylesheet preload" type=text/css></head><body><header class="web-header background-paper-secondary"><h2><a class=back-to-home href=/ title="Back to home"><i class="fas fa-home"></i><div class=back-to-home__content><span class=back-to-home__action>Back to home</span><div class=back-to-home__title><img alt="Sergio Carracedo" class=avatar src=/i/sergiocarracedo_hu15161314200389136556.jpg><h4>Sergio Carracedo</h4></div></div></a></h2><div class=web-header__page-title><span>Despliegue usando Deployer</span></div><div class=theme-switch><i class="theme-switch__theme fas fa-sun" id=theme-switch-light title="Switch to light theme"></i>
<i class="theme-switch__theme fas fa-moon" id=theme-switch-dark title="Switch to dark theme"></i></div></header><div class=main-content><article class="post post--single"><div class="post__main wrapper-1200"><aside class=post__metadata><time class=post__date datetime=2015-10-29><i class="far fa-calendar-alt"></i> Oct 29, 2015
</time><span class=post__reading-time><i class="far fa-clock"></i> 3 minutes read</span></aside><header class=post__header><h1 class=post__title>Despliegue usando Deployer</h1></header><figure class=post__cover><img alt="Despliegue usando Deployer" height=400 src=/2015/10/29/despliegue-usando-deployer/deployer_hu8011853129679115386.png width=1200></figure><div class=post__content><p>Desde el momento que ponemos un sistema en producción y necesitamos mantener el código o continuar el desarrollo surge una tediosa tarea, subir los cambios al servidor de producción. Esto normalmente lo hacemos empleando un FTP mediante el cual subimos los ficheros modificados. Pero ahi esta el &ldquo;problema&rdquo;, en muchos casos conocer los ficheros que se han modificado (aunque lo podemos hacer empleando <em>git</em> y comparando <em>commits</em> para obtener una lista de archivos cambiados) y una vez que los conocemos debemos subir a mano los ficheros modificados. </p><p>Esto es un proceso tedioso, además tenemos un riesgo alto de cometer un error sin una posiblidad sencilla de volver atrás. que en muchos proyectos no es aceptable.</p><p>Para resolver esto existen multiples automatizadores de despliegue, pero sobre el que vamos a hablar hoy es <a href=http://deployer.org/><strong>Deployer</strong></a></p><p>Este tipo de herramientas (y <em>Deployer</em> no es una excepción), emplea un repositiorio <em>git</em> como fuente del código (podemos usar <em>github</em>, <em>bitbucket</em>, etc), por lo que en primer lugar debemos garantizar que el servidor destino tiene acceso a esa repo, lo que normamente haremos usando un sistema de clave pública / privada que nos garantice acceso al repo.</p><p>Una vez que tenemos acceso al repo desde el servidor remoto, instalamos Deployer en nuestro equipo local y configuramos los parametros de conexión al servidor en el fichero deploy.php</p><p>Es imporante indicar que es posible establecer varios entornos, por si por ejemplo tenemos un enterono de desarrollo, o de stage antes de enviar a produción</p><p>Una vez configurado <em>Deployer</em> simplemente ejecutariamos </p><pre tabindex=0><code>dep deploy prod
</code></pre><p>y con esto deployer se encargará de  poner en producción las modificaciones que hubiesemos efectuado en el repo en unos instantes, y por defecto nos almacenará 3 displiegues por lo que si hay cualquier problema al desplejar, por ejemplo un error en el código, que se nos ha pasado por alto o algo que no funciona en el servidor con un simple</p><pre tabindex=0><code>dep rollback prod
</code></pre><p>Volveremos al estado anterior, todo ello en unos segundos</p><p><em>Deployer</em> funciona basado en un sistema de recetas, de hehco el propio <strong>deploy</strong> es una receta, esto nos permite, por ejemplo crear una receta que cree en el servidor de producciñon el archivo de configuracion de nuestro CMS, con las credenciasles de BBDD y otras configuraciones especificas del servidor, ya que doy por hehco que ese archivo no va a estar en tu repo git por razones obvias.</p><p>Tambien podemos indicar diractorios <em>shared</em>, que serán directorios, donde normalmente se almacena imagenes y recursos del usaurio, que no deberian estar en el repo, por ejemplo el diretior wp-uploads de <em>Wordpress</em> o <em>files</em> en Drupal de forma que se linkeen en cada despliegue sin necesidad de copiarlo. </p><p>En otra entrada de post explicaré como crear una receta, por ejemplo para Drupal 7, que nos permita configurar el <em>settings.php</em> o descargar a local el directorio <em>files.</em></p><p>Si quereis más información sobre Deployer y como ponerlo en marcha podeis consultar su <a href=http://deployer.org/docs>documentación</a></p></div></div><aside class=post__nav-wrapper><div class=wrapper-1200><div class="post-nav post-nav--prev"><a class=post-nav__link href="https://sergiocarracedo.es/2016/03/01/circuitos-de-formula-1-2016-en-google-maps/?ref=footer"><div class="post-nav__cover btn btn--img btn--hover-parent"><img alt=.Next.Title src=/2016/03/01/circuitos-de-formula-1-2016-en-google-maps/formula1_hu9162560052278380134.jpeg></div><div class=post-nav__title>Circuitos de Formula 1 (2016) en Google Maps</div></a></div><div class=blog-link><a class="btn btn--outlined" href=https://sergiocarracedo.es/blog>All Blog posts</a></div><div class="post-nav post-nav--next"><a class=post-nav__link href="https://sergiocarracedo.es/2015/02/05/sirve-tu-pagina-404-como-estatica-en-drupal/?ref=footer"><div class="post-nav__cover btn btn--img btn--hover-parent"><img alt=.Prev.Title class=post-nav__cover src=/2015/02/05/sirve-tu-pagina-404-como-estatica-en-drupal/pexels-photo-1579062_hu10204638335202730786.jpeg></div><div class=post-nav__title>Sirve tu página 404 como estática en Drupal</div></a></div></div><div class="wrapper-1200 post__nav-years"><ul class=years><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2024>2024</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2023>2023</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2022>2022</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2021>2021</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2020>2020</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2019>2019</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2018>2018</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2017>2017</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2016>2016</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2015>2015</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2013>2013</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2012>2012</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2011>2011</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2010>2010</a></li></ul></div></aside><aside class=post__search-wrapper><div class=wrapper-1200>Search in <strong>144</strong> blog posts:<form action=https://sergiocarracedo.es/search class="search-form search-form--dark search-form--l" method=get><label for=search-input hidden>Search</label>
<input class=search-form__input id=search-input name=query placeholder=Search type=text>
<button aria-label="Search in the blog" class=search-form__button>
<i class="fas fa-search"></i></button></form></div></aside><aside class=post__comments><div class=wrapper-1200><div id=disqus_thread>To show comments is mandatory to accept cookie policy.</div></div></aside></article></div><footer class="web-footer background-paper-secondary"><div class=wrapper-1200><div class=web-footer__left><div class=me><div class=me__avatar><img alt="Sergio Carracedo" height=180 src=/i/sergiocarracedo_hu3613990337080381956.jpg width=180></div><div class=me__titles><h1>Sergio Carracedo</h1><h2>Senior Fullstack developer.</h2><h3>Always learning, cats, good conversations and small details lover.</h3></div></div></div><div class=web-footer__right><nav class=menu><ul role=menu><li class=menu__item role=presentation><a role=menuitem href=https://sergiocarracedo.es/>Home</a></li><li class=menu__item role=presentation><a role=menuitem href=https://sergiocarracedo.es/blog>Blog</a></li></ul></nav><div class=social><a class=social__link href=http://www.linkedin.com/in/sergiocarracedo target=_blank title=LinkedIn style=animation-delay:2s><i class="fab fa-linkedin"></i>
</a><a class=social__link href=mailto:hi+blog@sergiocarracedo.es target=_blank title=Email style=animation-delay:1.9333333333333333s><i class="fas fa-envelope"></i>
</a><a class=social__link href=https://github.com/sergiocarracedo target=_blank title=GitHub style=animation-delay:1.8666666666666667s><i class="fab fa-github"></i>
</a><a class=social__link href=https://bsky.app/profile/sergiocarracedo.bsky.social target=_blank title=Bluesky style=animation-delay:1.8s><svg fill="none" viewBox="0 0 64 57"><path fill="currentcolor" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022.0 8.51.0 6.55.0-3.268 8.579-.182 13.873 3.805zm36.254.0C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745z"/></svg>
</a><a class=social__link href=https://www.drupal.org/u/sergiocarracedo target=_blank title=Drupal style=animation-delay:1.7333333333333334s><i class="fab fa-drupal"></i>
</a><a class=social__link href=https://www.npmjs.com/~sergiocarracedo target=_blank title=Npm style=animation-delay:1.6666666666666667s><svg viewBox="0 0 780 250" aria-hidden="true"><path fill="currentcolor" d="M240 250h1e2v-50h1e2V0H240V250zM340 50h50v1e2h-50V50zM480 0v2e2h1e2V50h50v150h50V50h50v150h50V0H480zM0 2e2h1e2V50h50v150h50V0H0V2e2z" stroke-width="5" stroke="currentcolor"/></svg>
</a><a class=social__link href=https://www.twitter.com/sergiocarracedo target=_blank title=Twitter style=animation-delay:1.6s><i class="fab fa-twitter"></i>
</a><a class=social__link href=http://www.last.fm/user/gasman40 target=_blank title=Last.fm style=animation-delay:1.5333333333333332s><i class="fab fa-lastfm"></i>
</a><a class=social__link href=http://sergiocarracedo.tumblr.com/ target=_blank title=Tumblr style=animation-delay:1.4666666666666668s><i class="fab fa-tumblr"></i></a></div></div></div></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-87X78TXEGE"></script><script>function runGA(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-87X78TXEGE")}</script><script>function runDisqus(){(function(){var e=document,t=e.createElement("script");t.src="https://sergiocarracedo.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()}</script><script src=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js></script><script>window.addEventListener("load",function(){window.cookieconsent.initialise({palette:{popup:{background:"#004262",text:"#fff"},button:{background:"#8ec760",text:"#ffffff"}},type:"opt-out",content:{message:"Este sitio usa cookies propias y de terceros para mejorar la experiencia de usuario y esas cosas.",allow:"Ok, continua",deny:"Nada de cookies",link:"Saber más",href:"https://sergiocarracedo.es/cookies"},onStatusChange:function(e){e=="allow"&&runCookiesAllowed()},onInitialise:function(e){e=="allow"&&runCookiesAllowed()}})})</script><script>addEventListener("scroll",e=>{let t=document.getElementsByTagName("body")[0];t&&window.scrollY>10?t.classList.add("not-in-top"):t.classList.remove("not-in-top")});function runCookiesAllowed(){runGA(),runDisqus()}</script><script integrity="sha256-hyPros3hoBf0jJM1+zayQLFFkchXwy4d/k2QMvk0sHs=" src=https://sergiocarracedo.es/js/theme.min.8723eba2cde1a017f48c9335fb36b240b14591c857c32e1dfe4d9032f934b07b.js></script><script src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js type=text/javascript></script><script integrity="sha256-RbHPlXzHpytxkjPwfQ5YOIACraziwCE1p/czQA3M/hM=" src=https://sergiocarracedo.es/js/search.min.45b1cf957cc7a72b719233f07d0e58388002adace2c02135a7f733400dccfe13.js></script></body></html>