<!doctype html><html><head><meta charset=utf-8><meta content="IE=edge,chrome=1" http-equiv=x-ua-compatible><meta content="width=device-width,minimum-scale=1" name=viewport><title>Sergio Carracedo | Vue Composition API: How to split and reuse code</title><meta content="yes" name=apple-mobile-web-app-capable><meta content="black-translucent" name=apple-mobile-web-app-status-bar-style><meta content="Sergio Carracedo's personal page and blog" name=description><meta content="Sergio Carracedo" name=author><link href=/favicon.png rel=icon><meta property="og:title" content="Vue Composition API: How to split and reuse code"><meta property="og:description" content="The Vue Composition API arrived at us in Nov 2018, 2 years ago, as a preview and become with some controversial, because people believed composition API would replace the traditional Object API, but would not.
Anyway, after start to develop Vue apps using the composition API I don&rsquo;t want to go back, maybe for very small components makes you write more code than with the Object API, but in most cases, you can take advantage of the composition API features."><meta property="og:type" content="article"><meta property="og:url" content="https://sergiocarracedo.es/vue-composition-api-how-to-split-and-reuse-code/"><meta property="og:image" content="https://sergiocarracedo.es/vue-composition-api-how-to-split-and-reuse-code/vue-composition-api-3y1zF4hIPCg-unsplash_hue3e183c5fa902cd4ae789f3e908b1fee_585022_1920x1080_fill_q75_box_center.jpg"><meta name=twitter:image content="https://sergiocarracedo.es/vue-composition-api-how-to-split-and-reuse-code/vue-composition-api-3y1zF4hIPCg-unsplash_hue3e183c5fa902cd4ae789f3e908b1fee_585022_1920x1080_fill_q75_box_center.jpg"></meta><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-11-02T00:00:00+00:00"><meta property="article:modified_time" content="2021-11-02T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"></meta><link rel=canonical href=https://sergiocarracedo.es/vue-composition-api-how-to-split-and-reuse-code/><link href=https://sergiocarracedo.es/scss/main.2fd96352cefb0fc6d22a709a5c49be2d08c4854cce0d451385d9b0e30adcce2e.css integrity="sha256-L9ljUs77D8bSKnCaXEm+LQjEhUzODUUThdmw4wrczi4=" rel=stylesheet><link href=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css rel=stylesheet type=text/css></head><body><header class=web-header><h2><a class=back-to-home href=/ title="Back to home"><i class="fas fa-home"></i><div class=back-to-home__content><span class=back-to-home__action>Back to home</span><div class=back-to-home__title><img alt="Sergio Carracedo" class=avatar src=/i/sergiocarracedo_hu6caa808ff324b89bfea4b9d7d1c850ee_80590_100x100_fit_q75_box.jpg><h4>Sergio Carracedo</h4></div></div></a></h2><div class=web-header__page-title><span>Vue Composition API: How to split and reuse code</span></div><div class=theme-switch><i class="theme-switch__theme fas fa-sun" id=theme-switch-light title="Switch to light theme"></i>
<i class="theme-switch__theme fas fa-moon" id=theme-switch-dark title="Switch to dark theme"></i></div></header><div class=main-content><article class="post post--single"><div class="post__main wrapper-1200"><aside class=post__metadata><time class=post__date datetime=2021-11-02><i class="far fa-calendar-alt"></i> Nov 2, 2021</time><div class=post__tags><a href=https://sergiocarracedo.es/tags/vue class=post__tag><span>vue</span></a></div><span class=post__reading-time><i class="far fa-clock"></i> 6 minutes read</span></aside><header class=post__header><h1 class=post__title>Vue Composition API: How to split and reuse code</h1></header><figure class=post__cover><img src=/vue-composition-api-how-to-split-and-reuse-code/vue-composition-api-3y1zF4hIPCg-unsplash_hue3e183c5fa902cd4ae789f3e908b1fee_585022_1200x400_fill_q75_box_center.jpg alt="Vue Composition API: How to split and reuse code" width=1200 height=400></figure><div class=post__content><p>The Vue Composition API arrived at us in Nov 2018, 2 years ago, as a <a href=https://medium.com/vue-mastery/evan-you-previews-vue-js-3-0-ab063dec3547>preview</a> and become with <a href=https://dev.to/danielelkington/vue-s-darkest-day-3fgh>some controversial</a>, because people believed composition API would replace the traditional Object API, but would not.</p><p>Anyway, after start to develop Vue apps using the composition API I don&rsquo;t want to go back, maybe for very small components makes you write more code than with the Object API, but in most cases, you can take advantage of the composition API features.</p><p>One of these features is code splitting, and by extension, code reusability.</p><h1 id=options-api>Options API</h1><p>With the Options API we could reuse code through the mixins. The mixins in Vue works like a kind of object composition. Your component will use all the data, methods, etc presents in the mixin, and you can rewrite it. Let see an example.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span><span style=color:#75715e>// Mixing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>props</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> String,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>size</span><span style=color:#f92672>:</span> String
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>computed</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>colorClasses</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> [<span style=color:#e6db74>`color-</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>color</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sizeClasses</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> [<span style=color:#e6db74>`size-</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>size</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Imagine we have components we can colorate or change the size, then our mixin includes the properties and the way (computed) to get the classes to apply, the mixing above do exactly that.</p><p>Now let write the component</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span><span style=color:#75715e>// Component 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>&lt;<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span> <span style=color:#f92672>:</span><span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;[&#39;component-a&#39;, ...colorClasses, ...sizeClasses]&#34;</span>&gt;
</span></span><span style=display:flex><span>    ....
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>colorSizeMixin</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;...&#39;</span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mixins</span><span style=color:#f92672>:</span> { 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>colorSizeMixin</span> 
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>This thing works, but only looking at the component file, it&rsquo;s very hard to know from where we get the <code>colorClasses</code> and <code>sizeClasses</code>. You need to go to the mixin definition to know from where we are getting the values or which properties you could use in your component.</p><p>Mixins have another limitation, mixin can&rsquo;t adapt the behavior (in a simple way), I mean, you can&rsquo;t change the mixin behavior passing to it a flag, in this example, for example, a list of valid colors to accept.</p><h1 id=composition-api>Composition API</h1><p>Let&rsquo;s do the same with the composition API</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// useClasses.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>computed</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> (<span style=color:#a6e22e>props</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>colorClasses</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`color-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>color</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sizeClasses</span> <span style=color:#f92672>=</span>  <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`size-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>size</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>colorClasses</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sizeClasses</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span><span style=color:#75715e>// Component (Vue 3)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>&lt;<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span> <span style=color:#f92672>:</span><span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;[&#39;component-a&#39;, ...colorClasses, ...sizeClasses]&#34;</span>&gt;
</span></span><span style=display:flex><span>    ....
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>defineComponent</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>useClasses</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;./useClasses.js&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>defineComponent</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>props</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> String,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>size</span><span style=color:#f92672>:</span> String
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setup</span>(<span style=color:#a6e22e>props</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>colorClasses</span>, <span style=color:#a6e22e>sizeClasses</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>useClasses</span>(<span style=color:#a6e22e>props</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>colorClasses</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sizeClasses</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>Now we have the same functionality, the <code>colorClasses</code> and <code>sizeClasses</code> can be reusable in another component as we had using mixins.</p><p>Composition API has some advantages:</p><ul><li>It&rsquo;s very easy to see from where the <code>colorClasses</code> and <code>sizeClasses</code> comes, and what input needs</li><li>We don&rsquo;t need to &ldquo;import&rdquo; or use all the methods as in the mixins, for example here we can only get the sizeClasses computed value (<code>const { sizeClasses } = useClasses(props)</code>) without any modification in the <code>useClasses.js</code></li><li>We can parameterize the behavior, for example:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// useClasses.js 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>computed</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> (<span style=color:#a6e22e>props</span>, <span style=color:#a6e22e>allowedColors</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>colorClasses</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>computed</span>(() =&gt;  <span style=color:#a6e22e>allowedColors</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>color</span>) <span style=color:#f92672>!==</span> <span style=color:#ae81ff>1</span> 
</span></span><span style=display:flex><span>        <span style=color:#f92672>?</span> [<span style=color:#e6db74>`color-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>color</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>        <span style=color:#f92672>:</span> []
</span></span><span style=display:flex><span>         
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sizeClasses</span> <span style=color:#f92672>=</span>  <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`size-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>size</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>colorClasses</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sizeClasses</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now we can pass to the <code>useClass</code> an array with all allowed colors that can be different in different components, with mixins that it&rsquo;s hard to achieve.</p><h2 id=splitting-the-code>Splitting the code</h2><p>Using this technique we can split our component&rsquo;s code into different &ldquo;uses&rdquo; files, and if we put the related functionalities in the same &ldquo;use&rdquo; file we can reuse it. For example, we have a that needs to control the window scroll, we can write a &ldquo;use&rdquo; file like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// useScroll.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>onBeforeUnmount</span>, <span style=color:#a6e22e>onMounted</span>, <span style=color:#a6e22e>Ref</span>, <span style=color:#a6e22e>ref</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@vue/composition-api&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>scrollY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ref</span>(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>scrollX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ref</span>(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Before update the reactive values we store it in a local variable
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>localX</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>localY</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>onScroll</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>e</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>localX</span> <span style=color:#f92672>=</span> window.<span style=color:#a6e22e>scrollX</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>localY</span> <span style=color:#f92672>=</span> window.<span style=color:#a6e22e>scrollY</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>//We only update reactive values every 100 to avoid a update it too much
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>setInterval</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>localX</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>scrollX</span>.<span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>scrollX</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>localX</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>localY</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>scrollY</span>.<span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>scrollY</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>localY</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }, <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onMounted</span>(() =&gt; {
</span></span><span style=display:flex><span>    window.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;scroll&#39;</span>, <span style=color:#a6e22e>onScroll</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onBeforeUnmount</span>(() =&gt; {
</span></span><span style=display:flex><span>    window.<span style=color:#a6e22e>removeEventListener</span>(<span style=color:#e6db74>&#39;scroll&#39;</span>, <span style=color:#a6e22e>onScroll</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scrollX</span>, <span style=color:#a6e22e>scrollY</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Note that we can set the scroll position directly to the <code>scrollX</code> and <code>scrollY</code> but we want to avoid triggering the re-render of the component several times, and we store the values in a local variable, and every 100ms we dump the values to the reactive variables.</p><p><a href=https://github.com/Tarektouati/vue-use-web>vue-use-web</a> is a library inspired on that.</p><h3 id=some-tips-passing-values-to-the-use-files>Some tips passing values to the &ldquo;use&rdquo; files</h3><p>In the example file <code>useClasses.js</code> I passed the component <code>props</code>, which means we pass all props, this is not very good, because the component using the &ldquo;use&rdquo; file must pass the necessary properties, and this couldn&rsquo;t happen.</p><p>It&rsquo;s better to define in the &ldquo;use&rdquo; signature the params we need. This is the previous code rewrite using this.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// useClasses.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>computed</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> (<span style=color:#a6e22e>color</span>, <span style=color:#a6e22e>size</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>colorClasses</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`color-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>color</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sizeClasses</span> <span style=color:#f92672>=</span>  <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`size-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>size</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>colorClasses</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sizeClasses</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And in the component</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>...
</span></span><span style=display:flex><span> <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>colorClasses</span>, <span style=color:#a6e22e>sizeClasses</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>useClasses</span>(<span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>color</span>, <span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>size</span>)
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>You probably realized, that now the computed variables inside the use file will never be updated event if the property changes. That&rsquo;s because the prop.color is a string and is passed as copy not as reference.</p><p>To solve that, we must pass the properties through a function:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>...
</span></span><span style=display:flex><span> <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>colorClasses</span>, <span style=color:#a6e22e>sizeClasses</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>useClasses</span>(() =&gt; <span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>color</span>, () =&gt;  <span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>size</span>)
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>And change our &ldquo;use&rdquo; file, adding the <code>()</code> to call the wrapper function and get the &ldquo;live&rdquo; value of the property</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// useClasses.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>computed</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> (<span style=color:#a6e22e>color</span>, <span style=color:#a6e22e>size</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>colorClasses</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`color-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>color</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sizeClasses</span> <span style=color:#f92672>=</span>  <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`size-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>size</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>colorClasses</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sizeClasses</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>As personal opinion I being using Composition API for a long time, even in Vue 2.x, and I prefer it over Options API because I feel the code is better, easier to read, easier to reuse, and could be code non-related with Vue, I mean you can write all the logic without use anything related with Vue and after all the &ldquo;calculations&rdquo; put the results in a reactive variable, so this code could be used in other frameworks.</p></div></div><aside class=post__nav-wrapper><div class=wrapper-1200><div class="post-nav post-nav--prev"><a class=post-nav__link href="https://sergiocarracedo.es/integration-tests-in-golang-with-dockertest/?ref=footer"><div class=post-nav__cover><img alt=.NextPage.Title src=/integration-tests-in-golang-with-dockertest/dockertest-pexels-miguel-3785927_hue3e183c5fa902cd4ae789f3e908b1fee_305531_200x120_fill_q75_box_center.jpg></div><div class=post-nav__title>Integration tests in Golang with dockertest</div></a></div><div class=blog-link><a class=btn href=https://sergiocarracedo.es/blog>All Blog posts</a></div><div class="post-nav post-nav--next"><a class=post-nav__link href="https://sergiocarracedo.es/database-migrations-in-golang/?ref=footer"><div class=post-nav__cover><img alt=.PrevPage.Title class=post-nav__cover src=/database-migrations-in-golang/go-migrate-pexels-james-wheeler-1598075_hue3e183c5fa902cd4ae789f3e908b1fee_456451_200x120_fill_q75_box_center.jpg></div><div class=post-nav__title>Database migrations in Golang.</div></a></div></div></aside><aside class=post__comments><div class=wrapper-1200><div id=disqus_thread>To show the comments is mandatory accept cookie policy.</div></div></aside></article></div><footer class=web-footer><div class=wrapper-1200><div class=web-footer__left><div class=me><div class=me__avatar><img alt="Sergio Carracedo" src=/i/sergiocarracedo_hu6caa808ff324b89bfea4b9d7d1c850ee_80590_170x170_fit_q75_box.jpg></div><div class=me__titles><h1>Sergio Carracedo</h1><h2>Senior Fullstack developer.</h2><h3>Formula 1, cats, good conversations and small details lover.</h3></div></div></div><div class=web-footer__right><nav role=main class=menu><ul><li class=menu__item><a href=https://sergiocarracedo.es/>Home</a></li><li class=menu__item><a href=https://sergiocarracedo.es/blog>Blog</a></li></ul></nav><div class=social><a class=social__link href=http://www.linkedin.com/in/sergiocarracedo target=_blank title=LinkedIn style=animation-delay:2s><i class="fab fa-linkedin"></i></a>
<a class=social__link href=mailto:hi+blog@sergiocarracedo.es target=_blank title=Email style=animation-delay:1.9333333333333333s><i class="fas fa-envelope"></i></a>
<a class=social__link href=https://github.com/sergiocarracedo target=_blank title=GitHub style=animation-delay:1.8666666666666667s><i class="fab fa-github"></i></a>
<a class=social__link href=https://www.drupal.org/u/sergiocarracedo target=_blank title=Drupal style=animation-delay:1.8s><i class="fab fa-drupal"></i></a>
<a class=social__link href=https://www.twitter.com/sergiocarracedo target=_blank title=Twitter style=animation-delay:1.7333333333333334s><i class="fab fa-twitter"></i></a>
<a class=social__link href=http://www.last.fm/user/gasman40 target=_blank title=Last.fm style=animation-delay:1.6666666666666667s><i class="fab fa-lastfm"></i></a>
<a class=social__link href=http://sergiocarracedo.tumblr.com/ target=_blank title=Tumblr style=animation-delay:1.6s><i class="fab fa-tumblr"></i></a></div></div></div></footer><script async src="https://www.googletagmanager.com/gtag/js?id=UA-133459072-1"></script>
<script>function runGA(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","UA-133459072-1")}</script><script>function runDisqus(){(function(){var e=document,t=e.createElement("script");t.src="https://sergiocarracedo.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()}</script><script src=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js></script>
<script>window.addEventListener("load",function(){window.cookieconsent.initialise({palette:{popup:{background:"#004262",text:"#fff"},button:{background:"#8ec760",text:"#ffffff"}},type:"opt-out",content:{message:"Este sitio usa cookies propias y de terceros para mejorar la experiencia de usuario y esas cosas.",allow:"Ok, continua",deny:"Nada de cookies",link:"Saber más",href:"https://sergiocarracedo.es/cookies"},onStatusChange:function(e){e=="allow"&&runCookiesAllowed()},onInitialise:function(e){e=="allow"&&runCookiesAllowed()}})})</script><script>addEventListener("scroll",e=>{let t=document.getElementsByTagName("body")[0];t&&window.scrollY>10?t.classList.add("not-in-top"):t.classList.remove("not-in-top")});function runCookiesAllowed(){runGA(),runDisqus()}</script><script integrity="sha256-6W09eoRhk1Og2XFEl4eaBSED33MOr8P1V5qaL3z+PEY=" src=https://sergiocarracedo.es/js/theme.e96d3d7a84619353a0d9714497879a052103df730eafc3f5579a9a2f7cfe3c46.js></script></body></html>