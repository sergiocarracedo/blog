<!doctype html><html><head><meta charset=UTF-8><meta content="IE=edge,chrome=1" http-equiv=X-UA-Compatible><meta content="width=device-width,minimum-scale=1" name=viewport><title>Sergio Carracedo | Vue Composition API: How to split and reuse code</title>
<meta content="yes" name=apple-mobile-web-app-capable><meta content="black-translucent" name=apple-mobile-web-app-status-bar-style><meta content="Sergio Carracedo's personal page and blog" name=description><meta content="Sergio Carracedo" name=author><link href=https://sergiocarracedo.es//index.xml rel=alternate title="Sergio Carracedo" type=application/rss+xml><link href=/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/site.webmanifest rel=manifest><link color=#5bbad5 href=/safari-pinned-tab.svg rel=mask-icon><meta content="#da532c" name=msapplication-TileColor><meta content="#ffffff" name=theme-color><link crossorigin href="https://fonts.googleapis.com/css2?family=Rozha+One:wght@400;500;600;700&display=swap" rel=preconnect><link crossorigin href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;500;600;700&display=swap" rel=preconnect><link crossorigin href="https://fonts.googleapis.com/css2?family=Allura:wght@400;500;600;700&display=swap" rel=preconnect><meta property="og:title" content="Vue Composition API: How to split and reuse code"><meta property="og:description" content="The Vue Composition API arrived at us in Nov 2018, 2 years ago, as a preview and become with some controversial, because people believed composition API would replace the traditional Object API, but would not.
Anyway, after start to develop Vue apps using the composition API I don&rsquo;t want to go back, maybe for very small components makes you write more code than with the Object API, but in most cases, you can take advantage of the composition API features."><meta property="og:type" content="article"><meta property="og:url" content="https://sergiocarracedo.es/vue-composition-api-how-to-split-and-reuse-code/"><meta property="og:image" content="https://sergiocarracedo.es/vue-composition-api-how-to-split-and-reuse-code/vue-composition-api-3y1zF4hIPCg-unsplash_hu10078078192581395495.jpg"><meta name=twitter:image content="https://sergiocarracedo.es/vue-composition-api-how-to-split-and-reuse-code/vue-composition-api-3y1zF4hIPCg-unsplash_hu10078078192581395495.jpg"></meta><meta property="article:section" content="blog">
<meta property="article:published_time" content="2021-11-02T00:00:00+00:00"><meta property="article:modified_time" content="2021-11-02T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"></meta>
<link href=https://sergiocarracedo.es/vue-composition-api-how-to-split-and-reuse-code/ rel=canonical><link href=https://sergiocarracedo.es/scss/main.min.eb2c7eed36db73868d33fc79aad24debed56125f83ac18652aad76126b0014a7.css integrity="sha256-6yx+7Tbbc4aNM/x5qtJN6+1WEl+DrBhlKq12EmsAFKc=" rel="stylesheet preconnect"><link href=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css rel="stylesheet preload" type=text/css></head><body><header class="web-header background-paper-secondary"><h2><a class=back-to-home href=/ title="Back to home"><i class="fas fa-home"></i><div class=back-to-home__content><span class=back-to-home__action>Back to home</span><div class=back-to-home__title><img alt="Sergio Carracedo" class=avatar src=/i/sergiocarracedo_hu15161314200389136556.jpg><h4>Sergio Carracedo</h4></div></div></a></h2><div class=web-header__page-title><span>Vue Composition API: How to split and reuse code</span></div><div class=theme-switch><i class="theme-switch__theme fas fa-sun" id=theme-switch-light title="Switch to light theme"></i>
<i class="theme-switch__theme fas fa-moon" id=theme-switch-dark title="Switch to dark theme"></i></div></header><div class=main-content><article class="post post--single"><div class="post__main wrapper-1200"><aside class=post__metadata><time class=post__date datetime=2021-11-02><i class="far fa-calendar-alt"></i> Nov 2, 2021
</time><a href=https://sergiocarracedo.es/tags/vue class=post__tag><span>vue</span>
</a><span class=post__reading-time><i class="far fa-clock"></i> 6 minutes read</span></aside><header class=post__header><h1 class=post__title>Vue Composition API: How to split and reuse code</h1></header><figure class=post__cover><img alt="Vue Composition API: How to split and reuse code" height=400 src=/vue-composition-api-how-to-split-and-reuse-code/vue-composition-api-3y1zF4hIPCg-unsplash_hu3379489524907859897.jpg width=1200></figure><div class=post__content><p>The Vue Composition API arrived at us in Nov 2018, 2 years ago, as a <a href=https://medium.com/vue-mastery/evan-you-previews-vue-js-3-0-ab063dec3547>preview</a> and become with <a href=https://dev.to/danielelkington/vue-s-darkest-day-3fgh>some controversial</a>, because people believed composition API would replace the traditional Object API, but would not.</p><p>Anyway, after start to develop Vue apps using the composition API I don&rsquo;t want to go back, maybe for very small components makes you write more code than with the Object API, but in most cases, you can take advantage of the composition API features.</p><p>One of these features is code splitting, and by extension, code reusability.</p><h1 id=options-api>Options API</h1><p>With the Options API we could reuse code through the mixins. The mixins in Vue works like a kind of object composition. Your component will use all the data, methods, etc presents in the mixin, and you can rewrite it. Let see an example.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span><span style=color:#75715e>// Mixing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>props</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> String,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>size</span><span style=color:#f92672>:</span> String
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>computed</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>colorClasses</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> [<span style=color:#e6db74>`color-</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>color</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sizeClasses</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> [<span style=color:#e6db74>`size-</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>size</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Imagine we have components we can colorate or change the size, then our mixin includes the properties and the way (computed) to get the classes to apply, the mixing above do exactly that.</p><p>Now let write the component</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span><span style=color:#75715e>// Component 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>&lt;<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span> <span style=color:#f92672>:</span><span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;[&#39;component-a&#39;, ...colorClasses, ...sizeClasses]&#34;</span>&gt;
</span></span><span style=display:flex><span>    ....
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>colorSizeMixin</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;...&#39;</span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mixins</span><span style=color:#f92672>:</span> { 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>colorSizeMixin</span> 
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>This thing works, but only looking at the component file, it&rsquo;s very hard to know from where we get the <code>colorClasses</code> and <code>sizeClasses</code>. You need to go to the mixin definition to know from where we are getting the values or which properties you could use in your component.</p><p>Mixins have another limitation, mixin can&rsquo;t adapt the behavior (in a simple way), I mean, you can&rsquo;t change the mixin behavior passing to it a flag, in this example, for example, a list of valid colors to accept.</p><h1 id=composition-api>Composition API</h1><p>Let&rsquo;s do the same with the composition API</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// useClasses.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>computed</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> (<span style=color:#a6e22e>props</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>colorClasses</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`color-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>color</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sizeClasses</span> <span style=color:#f92672>=</span>  <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`size-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>size</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>colorClasses</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sizeClasses</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span><span style=color:#75715e>// Component (Vue 3)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>&lt;<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span> <span style=color:#f92672>:</span><span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;[&#39;component-a&#39;, ...colorClasses, ...sizeClasses]&#34;</span>&gt;
</span></span><span style=display:flex><span>    ....
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>defineComponent</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>useClasses</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;./useClasses.js&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>defineComponent</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>props</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> String,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>size</span><span style=color:#f92672>:</span> String
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setup</span>(<span style=color:#a6e22e>props</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>colorClasses</span>, <span style=color:#a6e22e>sizeClasses</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>useClasses</span>(<span style=color:#a6e22e>props</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>colorClasses</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sizeClasses</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>Now we have the same functionality, the <code>colorClasses</code> and <code>sizeClasses</code> can be reusable in another component as we had using mixins.</p><p>Composition API has some advantages:</p><ul><li>It&rsquo;s very easy to see from where the <code>colorClasses</code> and <code>sizeClasses</code> comes, and what input needs</li><li>We don&rsquo;t need to &ldquo;import&rdquo; or use all the methods as in the mixins, for example here we can only get the sizeClasses computed value (<code>const { sizeClasses } = useClasses(props)</code>) without any modification in the <code>useClasses.js</code></li><li>We can parameterize the behavior, for example:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// useClasses.js 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>computed</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> (<span style=color:#a6e22e>props</span>, <span style=color:#a6e22e>allowedColors</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>colorClasses</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>computed</span>(() =&gt;  <span style=color:#a6e22e>allowedColors</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>color</span>) <span style=color:#f92672>!==</span> <span style=color:#ae81ff>1</span> 
</span></span><span style=display:flex><span>        <span style=color:#f92672>?</span> [<span style=color:#e6db74>`color-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>color</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>]
</span></span><span style=display:flex><span>        <span style=color:#f92672>:</span> []
</span></span><span style=display:flex><span>         
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sizeClasses</span> <span style=color:#f92672>=</span>  <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`size-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>size</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>colorClasses</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sizeClasses</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now we can pass to the <code>useClass</code> an array with all allowed colors that can be different in different components, with mixins that it&rsquo;s hard to achieve.</p><h2 id=splitting-the-code>Splitting the code</h2><p>Using this technique we can split our component&rsquo;s code into different &ldquo;uses&rdquo; files, and if we put the related functionalities in the same &ldquo;use&rdquo; file we can reuse it. For example, we have a that needs to control the window scroll, we can write a &ldquo;use&rdquo; file like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// useScroll.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>onBeforeUnmount</span>, <span style=color:#a6e22e>onMounted</span>, <span style=color:#a6e22e>Ref</span>, <span style=color:#a6e22e>ref</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@vue/composition-api&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>scrollY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ref</span>(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>scrollX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ref</span>(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Before update the reactive values we store it in a local variable
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>localX</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>localY</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>onScroll</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>e</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>localX</span> <span style=color:#f92672>=</span> window.<span style=color:#a6e22e>scrollX</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>localY</span> <span style=color:#f92672>=</span> window.<span style=color:#a6e22e>scrollY</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>//We only update reactive values every 100 to avoid a update it too much
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>setInterval</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>localX</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>scrollX</span>.<span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>scrollX</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>localX</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>localY</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>scrollY</span>.<span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>scrollY</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>localY</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }, <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onMounted</span>(() =&gt; {
</span></span><span style=display:flex><span>    window.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;scroll&#39;</span>, <span style=color:#a6e22e>onScroll</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onBeforeUnmount</span>(() =&gt; {
</span></span><span style=display:flex><span>    window.<span style=color:#a6e22e>removeEventListener</span>(<span style=color:#e6db74>&#39;scroll&#39;</span>, <span style=color:#a6e22e>onScroll</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scrollX</span>, <span style=color:#a6e22e>scrollY</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Note that we can set the scroll position directly to the <code>scrollX</code> and <code>scrollY</code> but we want to avoid triggering the re-render of the component several times, and we store the values in a local variable, and every 100ms we dump the values to the reactive variables.</p><p><a href=https://github.com/Tarektouati/vue-use-web>vue-use-web</a> is a library inspired on that.</p><h3 id=some-tips-passing-values-to-the-use-files>Some tips passing values to the &ldquo;use&rdquo; files</h3><p>In the example file <code>useClasses.js</code> I passed the component <code>props</code>, which means we pass all props, this is not very good, because the component using the &ldquo;use&rdquo; file must pass the necessary properties, and this couldn&rsquo;t happen.</p><p>It&rsquo;s better to define in the &ldquo;use&rdquo; signature the params we need. This is the previous code rewrite using this.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// useClasses.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>computed</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> (<span style=color:#a6e22e>color</span>, <span style=color:#a6e22e>size</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>colorClasses</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`color-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>color</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sizeClasses</span> <span style=color:#f92672>=</span>  <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`size-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>size</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>colorClasses</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sizeClasses</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And in the component</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>...
</span></span><span style=display:flex><span> <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>colorClasses</span>, <span style=color:#a6e22e>sizeClasses</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>useClasses</span>(<span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>color</span>, <span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>size</span>)
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>You probably realized, that now the computed variables inside the use file will never be updated event if the property changes. That&rsquo;s because the prop.color is a string and is passed as copy not as reference.</p><p>To solve that, we must pass the properties through a function:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>...
</span></span><span style=display:flex><span> <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>colorClasses</span>, <span style=color:#a6e22e>sizeClasses</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>useClasses</span>(() =&gt; <span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>color</span>, () =&gt;  <span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>size</span>)
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>And change our &ldquo;use&rdquo; file, adding the <code>()</code> to call the wrapper function and get the &ldquo;live&rdquo; value of the property</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// useClasses.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>computed</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> (<span style=color:#a6e22e>color</span>, <span style=color:#a6e22e>size</span>) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>colorClasses</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`color-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>color</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sizeClasses</span> <span style=color:#f92672>=</span>  <span style=color:#a6e22e>computed</span>(() =&gt; [<span style=color:#e6db74>`size-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>size</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>colorClasses</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sizeClasses</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>As personal opinion I being using Composition API for a long time, even in Vue 2.x, and I prefer it over Options API because I feel the code is better, easier to read, easier to reuse, and could be code non-related with Vue, I mean you can write all the logic without use anything related with Vue and after all the &ldquo;calculations&rdquo; put the results in a reactive variable, so this code could be used in other frameworks.</p></div></div><aside class=post__nav-wrapper><div class=wrapper-1200><div class="post-nav post-nav--prev"><a class=post-nav__link href="https://sergiocarracedo.es/integration-tests-in-golang-with-dockertest/?ref=footer"><div class="post-nav__cover btn btn--img btn--hover-parent"><img alt=.Next.Title src=/integration-tests-in-golang-with-dockertest/dockertest-pexels-miguel-3785927_hu3198692226417318529.jpg></div><div class=post-nav__title>Integration tests in Golang with dockertest</div></a></div><div class=blog-link><a class="btn btn--outlined" href=https://sergiocarracedo.es/blog>All Blog posts</a></div><div class="post-nav post-nav--next"><a class=post-nav__link href="https://sergiocarracedo.es/database-migrations-in-golang/?ref=footer"><div class="post-nav__cover btn btn--img btn--hover-parent"><img alt=.Prev.Title class=post-nav__cover src=/database-migrations-in-golang/go-migrate-pexels-james-wheeler-1598075_hu7210749433913724178.jpg></div><div class=post-nav__title>Database migrations in Golang.</div></a></div></div><div class="wrapper-1200 post__nav-years"><ul class=years><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2024>2024</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2023>2023</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2022>2022</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2021>2021</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2020>2020</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2019>2019</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2018>2018</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2017>2017</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2016>2016</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2015>2015</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2013>2013</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2012>2012</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2011>2011</a></li><li><a class=link href=https://sergiocarracedo.es/blog/by-year#2010>2010</a></li></ul></div></aside><aside class=post__search-wrapper><div class=wrapper-1200>Search in <strong>145</strong> blog posts:<form action=https://sergiocarracedo.es/search class="search-form search-form--dark search-form--l" method=get><label for=search-input hidden>Search</label>
<input class=search-form__input id=search-input name=query placeholder=Search type=text>
<button aria-label="Search in the blog" class=search-form__button>
<i class="fas fa-search"></i></button></form></div></aside><aside class=post__comments><div class=wrapper-1200><div id=disqus_thread>To show comments is mandatory to accept cookie policy.</div></div></aside></article></div><footer class="web-footer background-paper-secondary"><div class=wrapper-1200><div class=web-footer__left><div class=me><div class=me__avatar><img alt="Sergio Carracedo" height=180 src=/i/sergiocarracedo_hu3613990337080381956.jpg width=180></div><div class=me__titles><h1>Sergio Carracedo</h1><h2>Senior Fullstack developer.</h2><h3>Always learning, cats, good conversations and small details lover.</h3></div></div></div><div class=web-footer__right><nav class=menu><ul role=menu><li class=menu__item role=presentation><a role=menuitem href=https://sergiocarracedo.es/>Home</a></li><li class=menu__item role=presentation><a role=menuitem href=https://sergiocarracedo.es/blog>Blog</a></li><li class=menu__item role=presentation><a role=menuitem href=https://sergiocarracedo.es/index.xml>RSS Feed</a></li></ul></nav><div class=social><a class=social__link href=http://www.linkedin.com/in/sergiocarracedo target=_blank title=LinkedIn style=animation-delay:2s><i class="fab fa-linkedin"></i>
</a><a class=social__link href=mailto:hi+blog@sergiocarracedo.es target=_blank title=Email style=animation-delay:1.9333333333333333s><i class="fas fa-envelope"></i>
</a><a class=social__link href=https://github.com/sergiocarracedo target=_blank title=GitHub style=animation-delay:1.8666666666666667s><i class="fab fa-github"></i>
</a><a class=social__link href=https://bsky.app/profile/sergiocarracedo.bsky.social target=_blank title=Bluesky style=animation-delay:1.8s><svg fill="none" viewBox="0 0 64 57"><path fill="currentcolor" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022.0 8.51.0 6.55.0-3.268 8.579-.182 13.873 3.805zm36.254.0C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745z"/></svg>
</a><a class=social__link href=https://www.drupal.org/u/sergiocarracedo target=_blank title=Drupal style=animation-delay:1.7333333333333334s><i class="fab fa-drupal"></i>
</a><a class=social__link href=https://www.npmjs.com/~sergiocarracedo target=_blank title=Npm style=animation-delay:1.6666666666666667s><svg viewBox="0 0 780 250" aria-hidden="true"><path fill="currentcolor" d="M240 250h1e2v-50h1e2V0H240V250zM340 50h50v1e2h-50V50zM480 0v2e2h1e2V50h50v150h50V50h50v150h50V0H480zM0 2e2h1e2V50h50v150h50V0H0V2e2z" stroke-width="5" stroke="currentcolor"/></svg>
</a><a class=social__link href=https://www.twitter.com/sergiocarracedo target=_blank title=Twitter style=animation-delay:1.6s><i class="fab fa-twitter"></i>
</a><a class=social__link href=http://www.last.fm/user/gasman40 target=_blank title=Last.fm style=animation-delay:1.5333333333333332s><i class="fab fa-lastfm"></i>
</a><a class=social__link href=http://sergiocarracedo.tumblr.com/ target=_blank title=Tumblr style=animation-delay:1.4666666666666668s><i class="fab fa-tumblr"></i></a></div></div></div></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-87X78TXEGE"></script><script>function runGA(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-87X78TXEGE")}</script><script>function runDisqus(){(function(){var e=document,t=e.createElement("script");t.src="https://sergiocarracedo.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()}</script><script src=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js></script><script>window.addEventListener("load",function(){window.cookieconsent.initialise({palette:{popup:{background:"#004262",text:"#fff"},button:{background:"#8ec760",text:"#ffffff"}},type:"opt-out",content:{message:"Este sitio usa cookies propias y de terceros para mejorar la experiencia de usuario y esas cosas.",allow:"Ok, continua",deny:"Nada de cookies",link:"Saber más",href:"https://sergiocarracedo.es/cookies"},onStatusChange:function(e){e=="allow"&&runCookiesAllowed()},onInitialise:function(e){e=="allow"&&runCookiesAllowed()}})})</script><script>addEventListener("scroll",e=>{let t=document.getElementsByTagName("body")[0];t&&window.scrollY>10?t.classList.add("not-in-top"):t.classList.remove("not-in-top")});function runCookiesAllowed(){runGA(),runDisqus()}</script><script integrity="sha256-hyPros3hoBf0jJM1+zayQLFFkchXwy4d/k2QMvk0sHs=" src=https://sergiocarracedo.es/js/theme.min.8723eba2cde1a017f48c9335fb36b240b14591c857c32e1dfe4d9032f934b07b.js></script><script src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js type=text/javascript></script><script integrity="sha256-RbHPlXzHpytxkjPwfQ5YOIACraziwCE1p/czQA3M/hM=" src=https://sergiocarracedo.es/js/search.min.45b1cf957cc7a72b719233f07d0e58388002adace2c02135a7f733400dccfe13.js></script></body></html>