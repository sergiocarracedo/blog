<!doctype html><html><head><meta charset=utf-8><meta content="IE=edge,chrome=1" http-equiv=x-ua-compatible><meta content="width=device-width,minimum-scale=1" name=viewport><title>Sergio Carracedo | Deploying a static website in Azure Static Web Apps</title><meta content="yes" name=apple-mobile-web-app-capable><meta content="black-translucent" name=apple-mobile-web-app-status-bar-style><meta content="Sergio Carracedo's personal page and blog" name=description><meta content="Sergio Carracedo" name=author><link href=/favicon.png rel=icon><meta property="og:title" content="Deploying a static website in Azure Static Web Apps"><meta property="og:description" content="Nowadays JAMStack is trendy because a lot of reasons: performance, security, decoupling, etc.
JAMStack consists of pre-rendering your website or application&rsquo;s frontend and get the dynamic data from an API.
Your pre-rendered markup can be host in a server, but as it is static, your host only needs to serve static files, just HTML, CSS, and JS. You don&rsquo;t need to run any code on the server.
There are a lot of different options to deploy a static website, for example:"><meta property="og:type" content="article"><meta property="og:url" content="https://sergiocarracedo.es/azure-static-web-apps/"><meta property="og:image" content="https://sergiocarracedo.es/azure-static-web-apps/azureSWA_huc4446046f0b9afb72b14493c67d0a605_60761_1920x1080_fill_q75_box_center.jpg"><meta name=twitter:image content="https://sergiocarracedo.es/azure-static-web-apps/azureSWA_huc4446046f0b9afb72b14493c67d0a605_60761_1920x1080_fill_q75_box_center.jpg"></meta><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-01-20T00:00:00+00:00"><meta property="article:modified_time" content="2021-01-20T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"></meta><link href=https://sergiocarracedo.es/scss/main.2fd96352cefb0fc6d22a709a5c49be2d08c4854cce0d451385d9b0e30adcce2e.css integrity="sha256-L9ljUs77D8bSKnCaXEm+LQjEhUzODUUThdmw4wrczi4=" rel=stylesheet><link href=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css rel=stylesheet type=text/css></head><body><header class=web-header><h2><a class=back-to-home href=/ title="Back to home"><i class="fas fa-home"></i><div class=back-to-home__content><span class=back-to-home__action>Back to home</span><div class=back-to-home__title><img alt="Sergio Carracedo" class=avatar src=/i/sergiocarracedo_hu6caa808ff324b89bfea4b9d7d1c850ee_80590_100x100_fit_q75_box.jpg><h4>Sergio Carracedo</h4></div></div></a></h2><div class=web-header__page-title><span>Deploying a static website in Azure Static Web Apps</span></div><div class=theme-switch><i class="theme-switch__theme fas fa-sun" id=theme-switch-light title="Switch to light theme"></i>
<i class="theme-switch__theme fas fa-moon" id=theme-switch-dark title="Switch to dark theme"></i></div></header><div class=main-content><article class="post post--single"><div class="post__main wrapper-1200"><aside class=post__metadata><time class=post__date datetime=2021-01-20><i class="far fa-calendar-alt"></i> Jan 20, 2021</time><div class=post__tags><a href=https://sergiocarracedo.es/tags/devops class=post__tag><span>devops</span></a>
<a href=https://sergiocarracedo.es/tags/azure class=post__tag><span>azure</span></a></div><span class=post__reading-time><i class="far fa-clock"></i> 3 minutes read</span></aside><header class=post__header><h1 class=post__title>Deploying a static website in Azure Static Web Apps</h1></header><figure class=post__cover><img src=/azure-static-web-apps/azureSWA_huc4446046f0b9afb72b14493c67d0a605_60761_1200x400_fill_q75_box_center.jpg alt="Deploying a static website in Azure Static Web Apps" width=1200 height=400></figure><div class=post__content><p>Nowadays <a href=https://jamstack.org/>JAMStack</a> is trendy because a lot of reasons: performance, security, decoupling, etc.</p><p>JAMStack consists of pre-rendering your website or application&rsquo;s frontend and get the dynamic data from an API.</p><p>Your pre-rendered markup can be host in a server, but as it is static, your host only needs to serve static files, just HTML, CSS, and JS. You don&rsquo;t need to run any code on the server.</p><p>There are a lot of different options to deploy a static website, for example:</p><ul><li><a href=https://pages.github.com/>Github Pages</a></li><li><a href=https://www.netlify.com/>Netlify</a></li><li><a href=https://vercel.com/>Vercel</a></li><li>etc.</li></ul><p>In this post I will talk about <a href=https://azure.microsoft.com/en-us/services/app-service/static/>Azure Static Web Apps</a>, this is a service to host your static (and lambda functions)</p><p>At the moment of writing this post, it&rsquo;s in a preview, and it&rsquo;s free.</p><p>How to deploy your app, for example, a Vue app.</p><ol><li><p>Go to <a href=https://portal.azure.com/>https://portal.azure.com/</a> and create a new account if you haven&rsquo;t one yet.</p></li><li><p>Into the resource group click in <em>+ Create resource</em></p></li><li><p>Choose <strong>Static Web App (preview)</strong></p></li><li><p>You must select the subscription, the Resource group to assign this resource, the name of your app (to find it later in the Azure panel), the region where you want to serve the static files (choose one near your clients or users)</p></li><li><p>You need to link with your Github account and choose the repo (and the branch) to deploy.</p></li><li><p>Azure will create behalf you a Github Action to build your website and deploy it to SWA.</p></li></ol><p>Something like this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Azure Static Web Apps CI/CD</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>main </span> <span style=color:#75715e># This action will run on push to main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>build_and_deploy_job</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>if</span>: <span style=color:#ae81ff>github.event_name == &#39;push&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build and Deploy Job</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>submodules</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build And Deploy</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>id</span>: <span style=color:#ae81ff>builddeploy</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>Azure/static-web-apps-deploy@v0.0.1-preview</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>azure_static_web_apps_api_token</span>: <span style=color:#ae81ff>${{ secrets.AZURE_STATIC_WEB_APPS_API_TOKEN }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>repo_token</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span> <span style=color:#75715e># Used for Github integrations (i.e. PR comments)</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>action</span>: <span style=color:#e6db74>&#34;upload&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>app_location</span>: <span style=color:#e6db74>&#34;/&#34;</span> <span style=color:#75715e># Path to your app in the web server</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>api_location</span>: <span style=color:#e6db74>&#34;api&#34;</span> <span style=color:#75715e># Api source code path - optional</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>output_location</span>: <span style=color:#e6db74>&#34;dist&#34;</span>           
</span></span><span style=display:flex><span>        <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>VUE_APP_MY_VARIABLE</span>: <span style=color:#ae81ff>value</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e># Environment variables needed to build your app</span>
</span></span></code></pre></div><p>For more information about the actions you can read the official documentation: <a href=https://docs.microsoft.com/en-us/azure/static-web-apps/github-actions-workflow>https://docs.microsoft.com/en-us/azure/static-web-apps/github-actions-workflow</a></p><p>After doing this the Github action will run after every push to <code>master</code>, build the app, and deploy to azure.</p><blockquote><p>Azure provides you an url to access your website, like *.azurewebsites.net, you can also add your custom domain.</p></blockquote><h1 id=configuring-routes>Configuring routes</h1><p>If you need to configure the routes, for example securing a route to allow only access to your company users, add a fallback route, or create a redirect you need to create a file named <code>routes.json</code> which is in the root directory after the build, in Vue you must store this in the <code>static</code> folder.</p><p>For example, this file forces users to must authenticated to access to any route and if the page requested is not found redirects to <code>200.html</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;routes&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;route&#34;</span>: <span style=color:#e6db74>&#34;/*&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;allowedRoles&#34;</span>: [<span style=color:#e6db74>&#34;authenticated&#34;</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;platformErrorOverrides&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;errorType&#34;</span>: <span style=color:#e6db74>&#34;NotFound&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;serve&#34;</span>: <span style=color:#e6db74>&#34;/200.html&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;statusCode&#34;</span>: <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>} 
</span></span></code></pre></div><p>Mor info about routes.json <a href=https://docs.microsoft.com/en-us/azure/static-web-apps/routes>https://docs.microsoft.com/en-us/azure/static-web-apps/routes</a></p><p>I didn&rsquo;t mention you can use <em>lambdas</em> to run server-side code (it is not free), but maybe I will write more about that in the future.</p><p>To summarizing, <strong>Azure Static Web Apps</strong> is another option to deploy static web apps, if you are using Azure in your company can be a good option to keep all the infrastructure services on the same platform, and it&rsquo;s a simple alternative to deploy an App Service</p></div></div><aside class=post__nav-wrapper><div class=wrapper-1200><div class="post-nav post-nav--prev"><a class=post-nav__link href="https://sergiocarracedo.es/custom-svg-icon-set-management-with-vue/?ref=footer"><div class=post-nav__cover><img alt=.NextPage.Title src=/custom-svg-icon-set-management-with-vue/svg-iconset_hu19adf1a248ad14f55968af8b4f675360_99937_200x120_fill_q75_box_center.jpg></div><div class=post-nav__title>Custom SVG icon set management with Vue</div></a></div><div class=blog-link><a class=btn href=https://sergiocarracedo.es/blog>All Blog posts</a></div><div class="post-nav post-nav--next"><a class=post-nav__link href="https://sergiocarracedo.es/2020-in-a-nutshell/?ref=footer"><div class=post-nav__cover><img alt=.PrevPage.Title class=post-nav__cover src=/2020-in-a-nutshell/pexels-cottonbro-3401900_hue3e183c5fa902cd4ae789f3e908b1fee_461287_200x120_fill_q75_box_center.jpg></div><div class=post-nav__title>2020 in a nutshell</div></a></div></div></aside><aside class=post__comments><div class=wrapper-1200><div id=disqus_thread>To show the comments is mandatory accept cookie policy.</div></div></aside></article></div><footer class=web-footer><div class=wrapper-1200><div class=web-footer__left><div class=me><div class=me__avatar><img alt="Sergio Carracedo" src=/i/sergiocarracedo_hu6caa808ff324b89bfea4b9d7d1c850ee_80590_170x170_fit_q75_box.jpg></div><div class=me__titles><h1>Sergio Carracedo</h1><h2>Senior Fullstack developer.</h2><h3>Formula 1, cats, good conversations and small details lover.</h3></div></div></div><div class=web-footer__right><nav role=main class=menu><ul><li class=menu__item><a href=https://sergiocarracedo.es/>Home</a></li><li class=menu__item><a href=https://sergiocarracedo.es/blog>Blog</a></li></ul></nav><div class=social><a class=social__link href=http://www.linkedin.com/in/sergiocarracedo target=_blank title=LinkedIn style=animation-delay:2s><i class="fab fa-linkedin"></i></a>
<a class=social__link href=mailto:hi+blog@sergiocarracedo.es target=_blank title=Email style=animation-delay:1.9333333333333333s><i class="fas fa-envelope"></i></a>
<a class=social__link href=https://github.com/sergiocarracedo target=_blank title=GitHub style=animation-delay:1.8666666666666667s><i class="fab fa-github"></i></a>
<a class=social__link href=https://www.drupal.org/u/sergiocarracedo target=_blank title=Drupal style=animation-delay:1.8s><i class="fab fa-drupal"></i></a>
<a class=social__link href=https://www.twitter.com/sergiocarracedo target=_blank title=Twitter style=animation-delay:1.7333333333333334s><i class="fab fa-twitter"></i></a>
<a class=social__link href=http://www.last.fm/user/gasman40 target=_blank title=Last.fm style=animation-delay:1.6666666666666667s><i class="fab fa-lastfm"></i></a>
<a class=social__link href=http://sergiocarracedo.tumblr.com/ target=_blank title=Tumblr style=animation-delay:1.6s><i class="fab fa-tumblr"></i></a></div></div></div></footer><script async src="https://www.googletagmanager.com/gtag/js?id=UA-133459072-1"></script>
<script>function runGA(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","UA-133459072-1")}</script><script>function runDisqus(){(function(){var e=document,t=e.createElement("script");t.src="https://sergiocarracedo.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()}</script><script src=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js></script>
<script>window.addEventListener("load",function(){window.cookieconsent.initialise({palette:{popup:{background:"#004262",text:"#fff"},button:{background:"#8ec760",text:"#ffffff"}},type:"opt-out",content:{message:"Este sitio usa cookies propias y de terceros para mejorar la experiencia de usuario y esas cosas.",allow:"Ok, continua",deny:"Nada de cookies",link:"Saber más",href:"https://sergiocarracedo.es/cookies"},onStatusChange:function(e){e=="allow"&&runCookiesAllowed()},onInitialise:function(e){e=="allow"&&runCookiesAllowed()}})})</script><script>addEventListener("scroll",e=>{let t=document.getElementsByTagName("body")[0];t&&window.scrollY>10?t.classList.add("not-in-top"):t.classList.remove("not-in-top")});function runCookiesAllowed(){runGA(),runDisqus()}</script><script integrity="sha256-6W09eoRhk1Og2XFEl4eaBSED33MOr8P1V5qaL3z+PEY=" src=https://sergiocarracedo.es/js/theme.e96d3d7a84619353a0d9714497879a052103df730eafc3f5579a9a2f7cfe3c46.js></script></body></html>